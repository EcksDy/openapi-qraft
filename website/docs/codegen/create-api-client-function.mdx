---
sidebar_position: 2
sidebar_label: createAPIClient()
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# createAPIClient(...)

Qraft CLI generates a helper function `createAPIClient(...)`, which creates a Qraft API client with
the necessary `requestFn`, `queryClient`, and `baseUrl` for React Hooks.

```tsx
import { createAPIClient } from './api'

const api = createAPIClient({
  requestFn,
  queryClient,
  baseUrl,
})
```

### Arguments
1. `options?: QraftClientOptions` - **Optional** options to be used by the Qraft API client
   - `options.requestFn` - **Required** `requestFn` function to be used by Qraft Hooks.
   - `options.queryClient` - **Required** `QueryClient` instance to be used by Qraft Hooks.
   - `options.baseUrl` - **Required** base URL for the `requestFn` function.

### Returns
- Qraft API client with the necessary context for Qraft Hooks.
  It contains all the methods to interact with the API grouped in services.

### Examples

<Tabs>
  <TabItem value="basic" label="Basic" default>
    ```tsx title="src/fetch-queries.ts"
    import { requestFn } from '@openapi-qraft/react';
    import { createAPIClient } from './api'; // generated by OpenAPI Qraft CLI

    import { QueryClient, dehydrate } from '@tanstack/react-query';

    const queryClient = new QueryClient();

    // ⬇︎ Create a Qraft API client
    const api = createAPIClient({
      requestFn,
      queryClient,
      baseUrl: 'https://api.sandbox.monite.com/v1',
    });

    // ⬇︎ Fetch the `getPetById` query with the `queryClient`
    const pet = await qraft.pet.getPetById.fetchQuery(
      { parameters: { path: { petId: 1 } } }
    );

    console.log(pet.name); // `pet` is the result of the `getPetById` request

    dehydrate(queryClient); // Dehydrate the `queryClient` to be used for SSR
    ```
  </TabItem>
  <TabItem value="multiple-api-versions" label={<span style={{verticalAlign: 'middle'}}>Multiple API versions</span>}>
    In this example, we create a multiple API clients that manages two different API clients, each with its own `QueryClient`.
    This  mounts and unmounts `QueryClient` during the lifecycle of the application.

    This setup is particularly useful when you need to work with different API versions simultaneously, or when you're in the process
    of migrating from one API version to another.

    ```tsx title="src/MultipleAPIClientsApp.tsx"
    import { createAPIClient as createAPIClientV1 } from './api-v1'; // generated by OpenAPI Qraft CLI
    import { createAPIClient as createAPIClientV2 } from './api-v2'; // generated by OpenAPI Qraft CLI
    import { requestFn } from '@openapi-qraft/react';
    import { createContext, useContext, useMemo, useEffect, type ReactNode} from "react";
    import { QueryClient } from '@tanstack/react-query'

    // Create a context for multiple API clients
    const MultipleAPIClientsContext = createContext<{
      apiV1: ReturnType<typeof createAPIClientV1>;
      apiV2: ReturnType<typeof createAPIClientV2>;
    }>(null!);

    export default function MultipleAPIClientsApp({ children }: { children: ReactNode }) {
      const queryClient1 = useMemo(() => new QueryClient(), []);
      const queryClient2 = useMemo(() => new QueryClient(), []);

      const apiV1 = useMemo(() => createAPIClientV1({
        requestFn,
        queryClient: queryClient1,
        baseUrl: 'https://api.sandbox.monite.com/v1',
      }), [queryClient1]);

      const apiV2 = useMemo(() => createAPIClientV2({
        requestFn,
        queryClient: queryClient2,
        baseUrl: 'https://api.sandbox.monite.com/v2',
      }), [queryClient2]);

      useEffect(() => {
        queryClient1.mount();
        queryClient2.mount();
        return () => {
          queryClient1.unmount();
          queryClient2.unmount();
        };
      }, [queryClient1, queryClient2]);

      return (
        <MultipleAPIClientsContext.Provider value={{ apiV1, apiV2 }}>
          {children}
        </MultipleAPIClientsContext.Provider>
      );
    }

    function YourComponents() {
      const { apiV1, apiV2 } = useContext(MultipleAPIClientsContext);

      // Use `apiV1` and `apiV2` as needed
      // ...
    }
    ```
  </TabItem>
</Tabs>
